(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{148:function(t,s,n){"use strict";n.r(s);var a=n(0),e=Object(a.a)({},function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("div",{staticClass:"content"},[t._m(0),t._v(" "),t._m(1),t._v(" "),n("p",[t._v("从"),n("a",{attrs:{href:"http://developer.egret.com/cn/apidoc/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Api"),n("OutboundLink")],1),t._v("文档可以看出，所有的类基本都是按照 ...=>"),n("code",[t._v("egret.EventDispatcher")]),t._v(" => "),n("code",[t._v("egret.HashObject")]),t._v("的继承路径。")]),t._v(" "),n("p",[t._v("（HashObject是所有egret类的基类，作用是在每个对象初始化的时候给对象加一个hash值，这个hash值是一个全局自增的id值）")]),t._v(" "),n("p",[t._v("所有的显示对象都是继承了EventDispatcher，根据这点和命名可以隐约看出这个类是egret事件机制的关键。")]),t._v(" "),n("p",[t._v("根据Api暴露的方法可以看出和"),n("a",{attrs:{href:"https://github.com/primus/eventemitter3",target:"_blank",rel:"noopener noreferrer"}},[t._v("EventEmitter"),n("OutboundLink")],1),t._v("很像。")]),t._v(" "),t._m(2),n("p",[t._v("同样和dom的事件监听方式也很像，是一个典型的监听者模式，先注册(addEventListener)对应事件类型（type）的回调，当有事件派发（dispatch）时触发注册的事件回调。")]),t._v(" "),t._m(3),t._v(" "),t._m(4),t._v(" "),t._m(5),t._m(6),t._v(" "),t._m(7),t._v(" "),n("p",[t._v("往显示对象上注册事件监听，这个过程中会在$EventDispatcher属性上的eventsMap和captureEventsMap（取决于useCapture参数）上缓存事件的一些属性。目的是当事件派发时执行相应的回调。\naddEventListener和once的区别在于addEventListener注册的事件如果不主动remove的话会一直监听，而once注册的事件在被执行一次后会从监听的事件列表中移除。\n同一个显示对象的同一个type的事件的同一个事件的执行者（thisobj）的一个事件回调（listener）在同一个事件阶段（捕获/冒泡）只能监听一次。")]),t._v(" "),t._m(8),t._v(" "),n("p",[t._v("事件的流向载体是显示列表，也就是egret的parent和child关系。\ndispatch的过程其实就是拿到dispatcher上的eventsMap和captureEventsMap（\b看是冒泡还是捕获阶段）,看里面有没有这个事件的回调，然后执行。\negret.DisplayObject在dispatch的时候会去遍历父节点，然后将父节点\b一个个按顺序放入数组\b，然后再拷贝一份\b倒置顺序，然后合并两个数组，dispatch的时候再去遍历这个数组然后挨个\bnotify，这样就模拟了\b冒泡和捕获。")]),t._v(" "),t._m(9),t._v(" "),n("p",[t._v("dispatchEventWith内部调用了Event.create从对象池中获取事件对象，然后调用dispatchEvent，理论上比直接调用dispatchEvent性能要好。")]),t._v(" "),t._m(10),t._v(" "),n("p",[t._v("由于事件是通过显示列表的父子关系来实现冒泡和捕获，有时候我们想在子组件通知父组件做一些操作\b时\b，父组件监听一个自定义事件，子组件派发这个事件就行，但兄弟节点就不能实现这种事件通信。\n这个时候我们可以创建一个EventBus（new一个EventDispatcher），在\ba组件中\b通过EventBus来注册事件回调，然后在b组件通过EventBus派发事件。")]),t._v(" "),t._m(11),t._v(" "),t._m(12)])},[function(){var t=this.$createElement,s=this._self._c||t;return s("h1",{attrs:{id:"egret事件机制"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#egret事件机制","aria-hidden":"true"}},[this._v("#")]),this._v(" egret事件机制")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"egret事件的实现"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#egret事件的实现","aria-hidden":"true"}},[this._v("#")]),this._v(" egret事件的实现")])},function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("div",{staticClass:"language-ts extra-class"},[n("pre",{pre:!0,attrs:{class:"language-ts"}},[n("code",[n("span",{attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),n("span",{attrs:{class:"token class-name"}},[t._v("EventDispatcher")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("extends")]),t._v(" "),n("span",{attrs:{class:"token class-name"}},[t._v("HashObject")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("implements")]),t._v(" "),n("span",{attrs:{class:"token class-name"}},[t._v("IEventDispatcher")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{attrs:{class:"token comment"}},[t._v("// public")]),t._v("\n  "),n("span",{attrs:{class:"token function"}},[t._v("addEventListener")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token keyword"}},[t._v("type")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{attrs:{class:"token builtin"}},[t._v("string")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" listener"),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{attrs:{class:"token builtin"}},[t._v("Function")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" thisObject"),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{attrs:{class:"token builtin"}},[t._v("any")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" useCapture"),n("span",{attrs:{class:"token operator"}},[t._v("?")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{attrs:{class:"token builtin"}},[t._v("boolean")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" priority"),n("span",{attrs:{class:"token operator"}},[t._v("?")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{attrs:{class:"token builtin"}},[t._v("number")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("void")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),n("span",{attrs:{class:"token function"}},[t._v("once")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token keyword"}},[t._v("type")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{attrs:{class:"token builtin"}},[t._v("string")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" listener"),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{attrs:{class:"token builtin"}},[t._v("Function")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" thisObject"),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{attrs:{class:"token builtin"}},[t._v("any")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" useCapture"),n("span",{attrs:{class:"token operator"}},[t._v("?")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{attrs:{class:"token builtin"}},[t._v("boolean")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" priority"),n("span",{attrs:{class:"token operator"}},[t._v("?")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{attrs:{class:"token builtin"}},[t._v("number")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("void")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),n("span",{attrs:{class:"token function"}},[t._v("removeEventListener")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token keyword"}},[t._v("type")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{attrs:{class:"token builtin"}},[t._v("string")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" listener"),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{attrs:{class:"token builtin"}},[t._v("Function")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" thisObject"),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{attrs:{class:"token builtin"}},[t._v("any")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" useCapture"),n("span",{attrs:{class:"token operator"}},[t._v("?")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{attrs:{class:"token builtin"}},[t._v("boolean")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("void")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),n("span",{attrs:{class:"token function"}},[t._v("hasEventListener")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token keyword"}},[t._v("type")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{attrs:{class:"token builtin"}},[t._v("string")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{attrs:{class:"token builtin"}},[t._v("boolean")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),n("span",{attrs:{class:"token function"}},[t._v("willTrigger")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token keyword"}},[t._v("type")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{attrs:{class:"token builtin"}},[t._v("string")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{attrs:{class:"token builtin"}},[t._v("boolean")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),n("span",{attrs:{class:"token function"}},[t._v("dispatchEvent")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("event"),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Event"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{attrs:{class:"token builtin"}},[t._v("boolean")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),n("span",{attrs:{class:"token function"}},[t._v("dispatchEventWith")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token keyword"}},[t._v("type")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{attrs:{class:"token builtin"}},[t._v("string")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" bubbles"),n("span",{attrs:{class:"token operator"}},[t._v("?")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{attrs:{class:"token builtin"}},[t._v("boolean")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" data"),n("span",{attrs:{class:"token operator"}},[t._v("?")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{attrs:{class:"token builtin"}},[t._v("any")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" cancelable"),n("span",{attrs:{class:"token operator"}},[t._v("?")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{attrs:{class:"token builtin"}},[t._v("boolean")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{attrs:{class:"token builtin"}},[t._v("boolean")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),n("span",{attrs:{class:"token comment"}},[t._v("// private")]),t._v("\n  "),n("span",{attrs:{class:"token keyword"}},[t._v("constructor")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("target"),n("span",{attrs:{class:"token operator"}},[t._v("?")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" IEventDispatcher"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  $EventDispatcher"),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Object"),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),n("span",{attrs:{class:"token function"}},[t._v("$getEventMap")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("useCapture"),n("span",{attrs:{class:"token operator"}},[t._v("?")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{attrs:{class:"token builtin"}},[t._v("boolean")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{attrs:{class:"token builtin"}},[t._v("any")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),n("span",{attrs:{class:"token function"}},[t._v("$addListener")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token keyword"}},[t._v("type")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{attrs:{class:"token builtin"}},[t._v("string")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" listener"),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{attrs:{class:"token builtin"}},[t._v("Function")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" thisObject"),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{attrs:{class:"token builtin"}},[t._v("any")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" useCapture"),n("span",{attrs:{class:"token operator"}},[t._v("?")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{attrs:{class:"token builtin"}},[t._v("boolean")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" priority"),n("span",{attrs:{class:"token operator"}},[t._v("?")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{attrs:{class:"token builtin"}},[t._v("number")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" dispatchOnce"),n("span",{attrs:{class:"token operator"}},[t._v("?")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{attrs:{class:"token builtin"}},[t._v("boolean")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("void")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  \n  "),n("span",{attrs:{class:"token function"}},[t._v("$insertEventBin")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("list"),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{attrs:{class:"token builtin"}},[t._v("any")]),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("type")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{attrs:{class:"token builtin"}},[t._v("string")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" listener"),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{attrs:{class:"token builtin"}},[t._v("Function")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" thisObject"),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{attrs:{class:"token builtin"}},[t._v("any")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" useCapture"),n("span",{attrs:{class:"token operator"}},[t._v("?")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{attrs:{class:"token builtin"}},[t._v("boolean")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" priority"),n("span",{attrs:{class:"token operator"}},[t._v("?")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{attrs:{class:"token builtin"}},[t._v("number")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" dispatchOnce"),n("span",{attrs:{class:"token operator"}},[t._v("?")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{attrs:{class:"token builtin"}},[t._v("boolean")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{attrs:{class:"token builtin"}},[t._v("boolean")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  \n  "),n("span",{attrs:{class:"token function"}},[t._v("$removeEventBin")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("list"),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{attrs:{class:"token builtin"}},[t._v("any")]),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" listener"),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{attrs:{class:"token builtin"}},[t._v("Function")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" thisObject"),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{attrs:{class:"token builtin"}},[t._v("any")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{attrs:{class:"token builtin"}},[t._v("boolean")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),n("span",{attrs:{class:"token function"}},[t._v("$notifyListener")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("event"),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Event"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" capturePhase"),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{attrs:{class:"token builtin"}},[t._v("boolean")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{attrs:{class:"token builtin"}},[t._v("boolean")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"construct"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#construct","aria-hidden":"true"}},[this._v("#")]),this._v(" construct")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("先从构造函数开始，当"),s("code",[this._v("new")]),this._v("一个显示对象的时候，会调用父类"),s("code",[this._v("EventDispatcher")]),this._v("的构造函数，这时候会在当前显示对象上挂载一个属性名$EventDispatcher的对象。")])},function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{attrs:{class:"token comment"}},[t._v("// Keys的枚举代表$EventDispatcher对应的key")]),t._v("\n"),n("span",{attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("enum")]),t._v(" Keys"),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    eventTarget"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    eventsMap"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    captureEventsMap"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    notifyLevel\n"),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),n("span",{attrs:{class:"token class-name"}},[t._v("EventDispatcher")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("extends")]),t._v(" "),n("span",{attrs:{class:"token class-name"}},[t._v("HashObject")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("implements")]),t._v(" "),n("span",{attrs:{class:"token class-name"}},[t._v("IEventDispatcher")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),n("span",{attrs:{class:"token function"}},[t._v("constructor")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("target"),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v("IEventDispatcher "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("null")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{attrs:{class:"token keyword"}},[t._v("super")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{attrs:{class:"token keyword"}},[t._v("this")]),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("$EventDispatcher "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),n("span",{attrs:{class:"token number"}},[t._v("0")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" target "),n("span",{attrs:{class:"token operator"}},[t._v("?")]),t._v(" target "),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("this")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),n("span",{attrs:{class:"token number"}},[t._v("1")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),n("span",{attrs:{class:"token number"}},[t._v("2")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),n("span",{attrs:{class:"token number"}},[t._v("3")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{attrs:{class:"token number"}},[t._v("0")]),t._v("\n    "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("eventTarget：显示对象自身的引用")]),this._v(" "),s("li",[this._v("eventsMap：当前对象监听的事件列表对象")]),this._v(" "),s("li",[this._v("captureEventsMap：同eventsMap，eventsMap包含冒泡阶段的事件列表，captureEventsMap包含捕获阶段的事件列表")]),this._v(" "),s("li",[this._v("notifyLevel：处理事件函数的优先级")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"addeventlistener-once"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#addeventlistener-once","aria-hidden":"true"}},[this._v("#")]),this._v(" addEventListener/once")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"dispatchevent"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#dispatchevent","aria-hidden":"true"}},[this._v("#")]),this._v(" dispatchEvent")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"dispatchevent和dispatcheventwith"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#dispatchevent和dispatcheventwith","aria-hidden":"true"}},[this._v("#")]),this._v(" dispatchEvent和dispatchEventWith")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"evenbus跨组件通信"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#evenbus跨组件通信","aria-hidden":"true"}},[this._v("#")]),this._v(" evenBus跨组件通信")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"事件机制的注意点"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#事件机制的注意点","aria-hidden":"true"}},[this._v("#")]),this._v(" 事件机制的注意点")])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[s("p",[this._v("事件类型为字符串类型，容易造成冲突，事件类型尽量集中统一定义，通过业务加不同的前缀，规避和引擎定义的类型冲突。")])]),this._v(" "),s("li",[s("p",[this._v("事件注册的监听函数的执行者（thisobj）可能是其他对象，被引用的对象如果在从显示列表移除且希望被垃圾回收，这个时候还需要remove掉之前挂在其他对象上的事件监听，不然不会被gc。")])]),this._v(" "),s("li",[s("p",[this._v("事件流是基于显示对象的child和parent关系，如果派发的事件希望被监听到，事件的派发者必须是监听者的child或者自己本身。")])])])}],!1,null,null,null);e.options.__file="event.md";s.default=e.exports}}]);